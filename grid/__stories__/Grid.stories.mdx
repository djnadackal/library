import {
    Meta,
    Story,
    Props,
    Preview,
    ArgsTable
} from "@storybook/addon-docs/blocks";
import { withKnobs, text, array, object } from "@storybook/addon-knobs";
import Grid from "../src/index";
import GridComponent from "./index.js";
import CustomPanel from "./panels/CustomPanel";

<Meta title="Grid Component" component={Grid} />

# Grid

## Business component for showing large list of data in tabular view

`Grid` component consists of list of props.

### Props

<Props of={Grid} />

### Code

```jsx
const GridComponent = () => {
    const paginationType = "index"; // or - "cursor"

    // If paginationType = "index"
    const pageInfo = {
        pageNum: 1,
        pageSize: 300,
        total: 20000,
        lastPage: false // or - true
    };
    // Else if paginationType = "cursor"
    const pageInfo = {
        endCursor: 299,
        pageSize: 300,
        total: 20000,
        lastPage: false // or - true
    };

    const idAttribute = "travelId";
    const gridData = // JSON Data
    const columns = [
        {
            Header: "Id",
            accessor: "travelId",
            width: 50,
            disableFilters: true,
            disableSortBy: true,
            disableResizing: true,
            isSearchable: true,
            displayCell: (rowData) => {
                const { travelId } = rowData;
                return (
                    <div className="travelId-details">
                        <span>{travelId}</span>
                    </div>
                );
            }
        },
        {
            Header: "Flight",
            accessor: "flight",
            width: 100,
            innerCells: [
                {
                    Header: "Flight No",
                    accessor: "flightno",
                    isSearchable: true
                },
                {
                    Header: "Date",
                    accessor: "date",
                    isSearchable: true
                }
            ],
            sortValue: "flightno",
            isSearchable: true,
            displayCell: (rowData, DisplayTag) => {
                const { flightno, date } = rowData.flight;
                return (
                    <div className="flight-details">
                        <DisplayTag columnKey="flight" cellKey="flightno">
                            <strong>{flightno}</strong>
                        </DisplayTag>
                        <DisplayTag columnKey="flight" cellKey="date">
                            <span>{getValueOfDate(date, "cell")}</span>
                        </DisplayTag>
                    </div>
                );
            },
            editCell: (rowData, DisplayTag, rowUpdateCallBack) => {
                return (
                    <FlightEdit
                        rowData={rowData}
                        DisplayTag={DisplayTag}
                        rowUpdateCallBack={rowUpdateCallBack}
                    />
                );
            }
        }
    ];

    const columnToExpand = {
        Header: "Remarks",
        innerCells: [{ Header: "Remarks", accessor: "remarks" }],
        displayCell: (rowData, DisplayTag) => {
            const { remarks } = rowData;
            return (
                <div className="remarks-wrap details-wrap">
                    <DisplayTag columnKey="remarks" cellKey="remarks">
                        <ul>
                            <li>{remarks}</li>
                        </ul>
                    </DisplayTag>
                </div>
            );
        }
    };

    const getRowEditOverlay = (rowData, DisplayTag, rowUpdateCallBack) => {
        // Return a react component with required data bound to it, using DisplayTag.
        // Call back rowUpdateCallBack, whenever user is making any updates to the data.
        );
    };

    const calculateRowHeight = (row, gridColumns) => {
        // Do calculation and return an integer value
        return 50;
    };

    const rowActions = [
        { label: "edit" }, // Value is not required
        { label: "delete" }, // Value is not required
        { label: "Send SCR", value: "SCR" },
        { label: "Segment Summary", value: "SegmentSummary" },
        { label: "Open Summary", value: "OpenSummary" },
        { label: "Close Summary", value: "CloseSummary" }
    ];

    const rowActionCallback = (rowData, actionValue) => {
        // Will get user selected 'actionValue' and corresponding 'rowData'
    };

    const onRowUpdate = (originalRow, updatedRow) => {
        // Update grid data by replacing old data with new data
    };

    const onRowDelete = (originalRow) => {
        // Update grid data by removing data
    };

    const onRowSelect = (selectedRows) => {
        // Will get an array of selected rows
    };

    const onGridRefresh = () => {
        // Refresh Grid data
    };

    const loadMoreData = (updatedPageInfo) => {
        // If paginationType is "index", updatedPageInfo will be { (pageNum + 1), pageSize}
        // Else if paginationType is "cursor", updatedPageInfo will be { endCursor, pageSize}
        // Based on the pageInfo, make API call and re-render grid with updated data.
    };

    return (
        <Grid
            className="icargoCustomClass" // Optional
            title="AWBs" // Optional
            gridHeight="80vh" // Optional
            gridWidth="100%" // Optional
            gridData={gridData} // Required
            idAttribute={idAttribute} // Required
            paginationType={paginationType} // Required
            pageInfo={pageInfo} // Required
            loadMoreData={loadMoreData} // Optional
            columns={columns} // Required
            columnToExpand={columnToExpand} // Optional
            rowActions={rowActions} // Optional
            rowActionCallback={rowActionCallback} // Optional
            getRowEditOverlay={getRowEditOverlay} // Optional
            calculateRowHeight={calculateRowHeight} // Required
            expandableColumn // Optional
            onRowUpdate={onRowUpdate} // Optional
            onRowDelete={onRowDelete} // Optional
            onRowSelect={onRowSelect} // Optional
            onGridRefresh={onGridRefresh} // Optional
            CustomPanel={CustomPanel} // Optional - Any react component that has to be rendered inside the Grid header
            rowsToDeselect={rowsToDeselect} // Optional
            globalSearch // Optional
            columnFilter // Optional
            groupSort // Optional
            columnChooser // Optional
            exportData // Optional
        />
    );
};

export default GridComponent;
```

### Variants

#### With custom classname

<Story name="With custom classname">
    <GridComponent className="icargoCustomClass" />;
</Story>

```jsx
<Grid
    className="icargoCustomClass"
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
/>
```

#### With custom title

<Story name="With custom title">
    <GridComponent title="AWBs" />;
</Story>

```jsx
<Grid
    title="AWBs"
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
/>
```

#### With custom grid height

<Story name="With custom height">
    <GridComponent gridHeight="80vh" />;
</Story>

```jsx
<Grid
    gridHeight="80vh"
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
/>
```

#### With custom grid width

<Story name="With custom grid width">
    <GridComponent gridWidth="75%" />;
</Story>

```jsx
<Grid
    gridWidth="75%"
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
/>
```

#### With row expansion

<Story name="With row expansion">
    <GridComponent passColumnToExpand />;
</Story>

```jsx
const columnToExpand = {
    Header: "Remarks",
    innerCells: [
        { Header: "Remarks", accessor: "remarks" },
        { Header: "Details", onlyInTablet: true, accessor: "details" }
    ],
    displayCell: (rowData, DisplayTag) => {
        const { remarks } = rowData;
        return (
            <div className="remarks-wrap details-wrap">
                <DisplayTag columnKey="remarks" cellKey="remarks">
                    <ul>
                        <li>{remarks}</li>
                    </ul>
                </DisplayTag>
            </div>
        );
    }
};

<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    columnToExpand={columnToExpand}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
/>;
```

#### With column expansion

<Story name="With column expansion">
    <GridComponent expandableColumn />;
</Story>

```jsx
expandableColumn = true // or - expandableColumn = false

<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    expandableColumn
/>
```

#### With row actions

<Story name="With row actions">
    <GridComponent passRowActions passRowActionCallback />;
</Story>

```jsx
const rowActions = [
    { label: "edit" }, // Value is not required
    { label: "delete" }, // Value is not required
    { label: "Send SCR", value: "SCR" },
    { label: "Segment Summary", value: "SegmentSummary" },
    { label: "Open Summary", value: "OpenSummary" },
    { label: "Close Summary", value: "CloseSummary" }
];

const rowActionCallback = (rowData, actionValue) => {
    // Will get user selected 'actionValue' and corresponding 'rowData'
};

<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    rowActions={rowActions}
    rowActionCallback={rowActionCallback}
    getRowEditOverlay={getRowEditOverlay}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
/>;
```

#### With grid refresh

<Story name="With grid refresh">
    <GridComponent passOnGridRefresh />;
</Story>

```jsx
<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    onGridRefresh={onGridRefresh}
/>
```

#### With custom header panel

<Story name="With custom header panel">
    <GridComponent CustomPanel={CustomPanel} />;
</Story>

```jsx
<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    CustomPanel={CustomPanel}
/>
```

#### With rows deselect

<Story name="With rows deselect">
    <GridComponent enableRowDeselection />;
</Story>

```jsx
<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    rowsToDeselect={rowsToDeselect}
/>
```

#### With pagination

<Story name="With pagination">
    <GridComponent isNextPageAvailableCheck />;
</Story>

```jsx
const paginationType = "index"; // or - paginationType = "cursor"

// If paginationType = "index"
const pageInfo = {
    pageNum: 1,
    pageSize: 300,
    total: 20000,
    lastPage: false // or - lastPage: true
};

// If paginationType = "cursor"
const pageInfo = {
    endCursor: 299,
    pageSize: 300,
    total: 20000,
    lastPage: false // or - lastPage: true
};

const loadMoreData = (updatedPageInfo) => {
    // If paginationType is "index", updatedPageInfo will be { (pageNum + 1), pageSize}
    // Else if paginationType is "cursor", updatedPageInfo will be { endCursor, pageSize}
    // Based on the pageInfo, make API call and re-render grid with updated data.
};

<Grid
    gridData={gridData}
    loadMoreData={loadMoreData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
/>;
```

#### Hide globalSearch

<Story name="Hide globalSearch">
    <GridComponent globalSearch={false} />;
</Story>

```jsx
<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    globalSearch={false}
/>
```

#### Hide columnFilter

<Story name="Hide columnFilter">
    <GridComponent columnFilter={false} />;
</Story>

```jsx
<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    columnFilter={false}
/>
```

#### Hide groupSort

<Story name="Hide groupSort">
    <GridComponent groupSort={false} />;
</Story>

```jsx
<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    groupSort={false}
/>
```

#### Hide columnChooser

<Story name="Hide columnChooser">
    <GridComponent columnChooser={false} />;
</Story>

```jsx
<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    columnChooser={false}
/>
```

#### Hide exportData

<Story name="Hide exportData">
    <GridComponent exportData={false} />;
</Story>

```jsx
<Grid
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    columns={columns}
    calculateRowHeight={calculateRowHeight}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    exportData={false}
/>
```

#### With all props

<Story name="With all props">
    <GridComponent
        className="icargoCustomClass"
        title="AWBs"
        gridHeight="80vh"
        gridWidth="100%"
        isNextPageAvailableCheck
        passColumnToExpand
        expandableColumn
        passRowActions
        passRowActionCallback
        passOnGridRefresh
        CustomPanel={CustomPanel}
        enableRowDeselection
        globalSearch
        columnFilter
        groupSort
        columnChooser
        exportData
    />
    ;
</Story>

```jsx
<Grid
    className={className}
    title={title}
    gridHeight={gridHeight}
    gridWidth={gridWidth}
    gridData={gridData}
    idAttribute={idAttribute}
    paginationType={paginationType}
    pageInfo={gridPageInfo}
    loadMoreData={loadMoreData}
    columns={columns}
    columnToExpand={columnToExpand}
    rowActions={rowActions}
    rowActionCallback={rowActionCallback}
    getRowEditOverlay={getRowEditOverlay}
    calculateRowHeight={calculateRowHeight}
    expandableColumn={expandableColumn}
    onRowUpdate={onRowUpdate}
    onRowDelete={onRowDelete}
    onRowSelect={onRowSelect}
    onGridRefresh={onGridRefresh}
    CustomPanel={CustomPanel}
    rowsToDeselect={rowsToDeselect}
    globalSearch={globalSearch}
    columnFilter={columnFilter}
    groupSort={groupSort}
    columnChooser={columnChooser}
    exportData={exportData}
/>
```
